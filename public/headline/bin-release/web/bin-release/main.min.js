var application;!function(t){function e(e){t.main=e,t.baseUrl="http://www.weiyoushijie.com/",t.dao=new Dao(t.baseUrl+"api/","headline"),t.projects=Project.createAllProjects(),t.stopwatch=new egret.EventDispatcher,t.units=["k","m","b","t","a","A","c","C","d","D","e","E","f","F","g","G","h","H","i","I","j","J","l","L","n","N","o","O","p","P","q","Q","r","R","s","S","u","U","v","V","w","W","x","X","y","Y","z","Z","aa","AA","cc","CC","dd","DD","ee","EE","ff","FF","gg","GG","hh","HH","ii","II","jj","JJ","ll","LL","nn","NN","oo","OO","pp","PP","qq","QQ","rr","RR","ss","SS","uu","UU","vv","VV","ww","WW","xx","XX","yy","YY","zz","ZZ"]}function i(e){if(null==e||"string"==typeof e){var i=e?{loginType:e}:{};nest.user.login(i,t.onLoginCallback)}else t.onLoginCallback(e)}function n(e){var i=this;t.dao.rest("login",{token:e.token},function(e,n){if(e){if(t.customer=n,esa.EgretSA.player.init({egretId:n.uid,level:1,serverId:1,playerName:n.name}),0==t.customer.metal&&(t.guideUI=new GuideUI),1==t.customer.vip){var o=new Date(t.customer.ticket),a=new Date;o.getTime()<a.getTime()&&(t.customer.ticket="",t.customer.vip=0)}var s=new egret.Timer(1e3,0);s.addEventListener(egret.TimerEvent.TIMER,function(e){t.ticks++,t.stopwatch.dispatchEventWith("second",!0,t.ticks),t.ticks%60==0&&(t.stopwatch.dispatchEventWith("miniute",!0,t.ticks/60),t.ticks%3600==0&&t.stopwatch.dispatchEventWith("hour",!0,t.ticks/3600))},i),s.start(),t.refreshBid(function(e){t.main.dispatchEventWith(GameEvents.EVT_LOGIN_IN_SUCCESS)})}else Toast.launch("获取账号信息失败")})}function o(t,e){var i=new egret.Timer(e,1);i.addEventListener(egret.TimerEvent.TIMER,function(e){t()},this),i.start()}function a(){var t=new Date;return t.getHours()>=12&&(t=new Date(t.getTime()+864e5)),t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()}function s(e){t.dao.fetch("Bid",{succeed:0,day:t.bidDay(),customer_id:t.customer.id},{limit:1},function(i,n){i&&n.length>0?t.bid=n[0]:t.bid=null,e(t.bid)})}function r(){t.dao.fetch("Bid",{customer_id:t.customer.id,succeed:1,claimed:0},{},function(e,i){if(e&&i.length>0){for(var n=0;n<i.length;n++)t.customer.gold-=i[n].gold,t.customer.metal++,t.customer.diamond+=2e3,i[n].claimed=1,t.dao.save("Bid",i[n]);t.saveCustomer()}})}function c(){t.customer.gold=Math.max(0,t.customer.gold),t.customer.accumulated_gold=Math.max(t.customer.accumulated_gold,t.customer.gold),t.customer.diamond=Math.max(0,t.customer.diamond),t.dao.save("Customer",t.customer)}function h(){t.dao.dispatchEventWith("Gift",!0,null)}function d(){t.customer.offline_gold>0&&t.earnGold(t.customer.offline_gold)}function u(e){t.earnedGold+=e;var i=t.customer.gold;t.customer.gold+=t.earnedGold,i!=t.customer.gold&&(t.customer.accumulated_gold+=t.earnedGold,t.earnedGold=0),t.saveCustomer()}function l(e){t.earnedGold>e?t.earnedGold-=e:(t.customer.gold=t.customer.gold+t.earnedGold-e,t.earnedGold=0),t.saveCustomer()}function g(){return t.bid?Math.max(0,t.customer.gold-t.bid.gold+t.earnedGold):Math.max(0,t.customer.gold+t.earnedGold)}function p(e,i,n){e=Math.abs(e),i=Math.abs(i),n=Math.abs(n),t.customer.diamond-=i,t.customer.output+=n,t.useGold(e),t.customer.output>=100&&t.log10(t.customer.output)>t.log10(t.customer.output-n)&&t.dao.fetch("Gift",{customer_id:t.customer.id,category:7},{limit:1},function(e,i){if(e&&i.length>0){var n=i[0];n.locked=0,t.dao.save("Gift",n)}})}function m(e,i,n){var o=0==t.customer.charge,a={customer_id:t.customer.id,product:e,price:n,state:0};t.dao.save("Order",a,function(e,n){e?(nest.iap.pay({goodsId:i,goodsNumber:"1",serverId:"1",ext:n.id},function(e){0==e.result||(-1==e.result?(n.reason="用户取消了支付",t.dao.save("Order",n)):(n.reason=JSON.stringify(e),t.dao.save("Order",n),Toast.launch("支付失败")))}),t.checkOrderPayed(n,10,o)):Toast.launch("保存订单失败，请稍后再试")})}function f(e,i,n){t.delay(function(){t.dao.fetch("Order",{id:e.id,state:1},{},function(o,a){if(o&&a.length>0){var s=a[0];if("Diamond"==s.product){var r=200;5==s.price?r=600:10==s.price?r=1300:30==s.price?r=4500:100==s.price?r=18e3:500==s.price&&(r=1e5),t.customer.diamond+=r,t.saveCustomer(),n?(Toast.launch("购买了"+r.toString()+"钻石,并获得了1500钻，1000k金币和1个奖章的首充礼物"),t.giftChanged()):Toast.launch("购买了"+r.toString()+"钻石")}else t.dao.fetch("Order",{customer_id:t.customer.id,product:"Ticket",state:1},{},function(e,i){if("Ticket"==s.product){if(e&&i.length>=2)var o=0;else var o=1;var a=new Date;a=new Date(a.getTime()+2592e6),t.customer.ticket=a.toString(),t.customer.vip=1,t.customer.metal+=o,t.saveCustomer(),n?(Toast.launch("购买了月票,并获得了1500钻，1000k金币和1个奖章的首充礼物"),t.giftChanged()):Toast.launch("购买了月票")}else{if(e&&i.length>=1)var o=2;else var o=3;t.customer.ticket="",t.customer.vip=2,t.customer.metal+=o,t.saveCustomer(),n?(Toast.launch("购买了VIP,并获得了1500钻，1000k金币和1个奖章的首充礼物"),t.giftChanged()):Toast.launch("购买了VIP")}})}else i-=1,i>0?t.checkOrderPayed(e,i,n):Toast.launch("支付超时，请稍后再试")})},1e3)}function v(e,i){t.buy("Diamond",e,i)}function _(){t.buy("Ticket","ticket",19)}function E(){t.buy("VIP","vip",49)}function T(e){nest.share.isSupport({},function(i){if(1==i.share){var n=t.baseUrl+"headline/index.html",o=t.baseUrl+"headline/resource/art/home/icon.png";nest.share.share({title:"我来上头条，女神任我挑！",description:"最炫最浪的舞蹈经营类游戏，无需下载，点开即送，多重豪礼等你来拿！",url:n,img_url:o,img_title:"头条关注"},function(t){0==t.result?e():-1==t.result?Toast.launch("取消了分享"):Toast.launch("分享失败")})}else Toast.launch("当前平台不支持分享")})}function C(t){nest.app.isSupport({},function(e){1==e.attention?nest.app.attention({},function(e){0==e.result?t():-1==e.result?Toast.launch("取消了关注"):Toast.launch("关注失败")}):Toast.launch("当前平台不支持关注")})}function U(){t.main.homeUI.gotoPage(GamePages.HOME,!0)}function I(){t.main.homeUI.gotoPage(GamePages.AUCTION,!1)}function k(){t.main.homeUI.gotoPage(GamePages.TOOL,!1)}function b(e){if(0==e.length){e+="玩法\n",e+="1. 点击中间舞者可产生金币，金币用来升级运营项目，而运营项目随等级提高从而产生更多的金币。\n",e+="2. 金币可以用来参加头条拍卖，每天最高出价者会成为头条，获得头条殊荣，勋章和钻石奖励。\n",e+="3. 道具可以帮助玩家快速获得大量金币和永久提高运营项目的每秒产量。\n",e+="4. 排行榜会按照勋章的个数排名，勋章数量一致时则按照金币的总量排名。\n";var i=Math.round(egret.sys.measureText(" ","Arial",24,!1,!1)),n=Math.round(egret.sys.measureText("276个0          zz","Arial",24,!1,!1)),o=[];o.push("金币单位");for(var a=0;a<t.units.length;a++){for(var s=(3*(a+1)).toString()+"个0",r=Math.round((n-egret.sys.measureText(s+t.units[a],"Arial",24,!1,!1))/i),c=0;r>c;c++)s+=" ";o.push(s+t.units[a])}for(var h=Math.floor((380-n)/(2*i)),d="",c=0;h>c;c++)d+=" ";for(var a=0;a<o.length;a++)e+=d+o[a]+"\n"}return t.showUI(new HelpUI(e))}function y(e,i){return e.horizontalCenter=0,e.verticalCenter=0,t.blockUI||(t.blockUI=new BlockUI),t.blockUI.addChild(e),t.guideUI?i?i.contains(t.guideUI)?i.addChildAt(t.blockUI,i.getChildIndex(t.guideUI)):i.addChild(t.blockUI):t.main.homeUI.addChildAt(t.blockUI,i.getChildIndex(t.guideUI)):i?i.addChild(t.blockUI):t.main.homeUI.addChild(t.blockUI),e}function G(e){return e&&e.parent&&(e.parent==t.blockUI?(t.blockUI.numChildren<=2&&e.parent.parent&&e.parent.parent.removeChild(t.blockUI),t.blockUI.removeChild(e)):e.parent.removeChild(e)),e}function L(e){try{if(99999>=e)return e.toString();for(var i="",n=0;n<t.units.length;n++){if(10>e)return e.toFixed(2)+i;if(100>e)return e.toFixed(1)+i;if(1e3>e)return e.toFixed()+i;i=t.units[n],e/=1e3}return e.toFixed()+i}catch(o){return console.error("format "+e.toString()+" error "+o.message),"0"}}function P(t){for(var e=0;t>=10;)e+=1,t/=10;return e}function R(e){if(e.avatar&&e.avatar.length>1)return e.avatar;var i=t.baseUrl+"headline/resource/art/";return 1==e.sex?i+"headM.png":2==e.sex?i+"headF.png":i+"head.png"}t.earnedGold=0,t.ticks=0,t.init=e,t.login=i,t.onLoginCallback=n,t.delay=o,t.bidDay=a,t.refreshBid=s,t.earnBids=r,t.saveCustomer=c,t.giftChanged=h,t.earnOfflineGold=d,t.earnGold=u,t.useGold=l,t.usableGold=g,t.buyOutput=p,t.buy=m,t.checkOrderPayed=f,t.charge=v,t.buyTicket=_,t.buyVIP=E,t.share=T,t.attention=C,t.gotoHome=U,t.gotoAuction=I,t.gotoTool=k,t.showHelp=b,t.showUI=y,t.hideUI=G,t.format=L,t.log10=P,t.avatarUrl=R}(application||(application={}));var Dao=function(t){function e(e,i){t.call(this),this._baseUrl=e,this._gameName=i}__extends(e,t);var i=(__define,e),n=i.prototype;return n.fetch=function(t,e,i,n){e?e.game=this._gameName:e={game:this._gameName},this.rest("select/"+t,{conditions:e,filters:i},n)},n.save=function(t,e,i){var n=this,o=function(o,a){o&&(n.dispatchEventWith(t,!0,a),e=a),i&&i(o,a)};e.game=this._gameName,e.id?this.rest("update/"+t+"/"+e.id,e,o):this.rest("create/"+t,e,o)},n.rest=function(t,e,i){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.open(this._baseUrl+t+"?game="+this._gameName,egret.HttpMethod.POST),n.setRequestHeader("Content-Type","application/json"),n.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;console.log("post data : ",e.response),i&&i(!0,JSON.parse(e.response))},this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){i&&i(!1,event)},this),n.addEventListener(egret.ProgressEvent.PROGRESS,function(t){console.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},this),n.send(JSON.stringify(e))},e}(egret.EventDispatcher);egret.registerClass(Dao,"Dao");var GameEvents=function(){function t(){}var e=(__define,t);e.prototype;return t.EVT_RETURN="EVT_RETURN",t.EVT_LOAD_PAGE="EVT_LOAD_PAGE",t.EVT_CLOSE_ABOUT="EVT_CLOSE_ABOUT",t.EVT_LOGIN_IN_SUCCESS="EVT_LOGIN_IN_SUCCESS",t.EVT_LOGIN_OUT_SUCCESS="EVT_LOGIN_OUT_SUCCESS",t.EVT_REFRESH_CUSTOMER="EVT_REFRESH_CUSTOMER",t}();egret.registerClass(GameEvents,"GameEvents");var GamePages=function(){function t(){}var e=(__define,t);e.prototype;return t.HOME="home",t.RANK="rank",t.TOOL="tool",t.AUCTION="auction",t.HELP="help",t.OFFLINEGOLD="offline gold",t.CHARGEBONUS="charge bonus",t.GIFT="gift",t}();egret.registerClass(GamePages,"GamePages");var Main=function(t){function e(){t.apply(this,arguments),this._isThemeLoadEnd=!1,this._isResourceLoadEnd=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),egret.TextField.default_fontFamily="STXihei",esa.EgretSA.init({gameId:"536E77465847413D",chanId:egret.getOption("egret.runtime.spid"),debug:!1}),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this._loadingUI=new LoadingUI,this.stage.addChild(this._loadingUI),esa.EgretSA.loadingSet(1,"开始加载配置文件"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){esa.EgretSA.loadingSet(2,"开始加载皮肤主题资源"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},n.onThemeLoadComplete=function(){this._isThemeLoadEnd=!0,this.createScene()},n.onResourceLoadComplete=function(t){var e=this;switch(t.groupName){case"loading":this._loadingUI.parent&&this._loadingUI.parent.removeChild(this._loadingUI),application.init(this),Toast.init(this,RES.getRes("toast-bg_png")),this._trueLoadingUI=new TrueLoadingUI,esa.EgretSA.loadingSet(3,"开始加载着陆页面"),this.loadPage("landing");break;case"landing":this.addChild(new LandingUI),this.addEventListener(GameEvents.EVT_LOGIN_IN_SUCCESS,function(t){e.loadPage("home")},this);break;case"home":this._trueLoadingUI.removeBgImage(),this._isResourceLoadEnd=!0,this.createScene();break;default:console.log("	page["+t.groupName+"]ok:",egret.getTimer()),this.pageLoadedHandler(t.groupName)}},n.clearRESEvents=function(){},n.createScene=function(){this._isThemeLoadEnd&&this._isResourceLoadEnd&&this.startCreateScene()},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){switch(t.groupName){case"loading":this._loadingUI.setProgress(t.itemsLoaded,t.itemsTotal);break;default:this._trueLoadingUI.setProgress(t.itemsLoaded,t.itemsTotal)}},n.startCreateScene=function(){var t=this;this.pageLoadedHandler("home"),this.homeUI=new HomeUI,this.homeUI.addEventListener(GameEvents.EVT_LOAD_PAGE,function(e){t.loadPage(e.data)},this),this.addChild(this.homeUI)},n.loadPage=function(t){this.addChild(this._trueLoadingUI),this._idLoading=t,RES.loadGroup(t)},n.pageLoadedHandler=function(t){"home"!=t&&this.homeUI.pageReadyHandler(this._idLoading),this._trueLoadingUI.parent&&this._trueLoadingUI.parent.removeChild(this._trueLoadingUI)},e}(eui.UILayer);egret.registerClass(Main,"Main");var AssetAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var Project=function(){function t(t,e){this._priceLevelOne=t,this._outputLevelOne=e,this._levelRatios=new Array,this._achieves=new Array}var e=(__define,t),i=e.prototype;return i.addLevelRatio=function(t,e,i,n){var o=1,a=1;if(this._levelRatios.length>0){var s=this._levelRatios[this._levelRatios.length-1],r=s.upperLevel-s.lowerLevel+1;o=s.outputRatioBase*Math.pow(s.outputRatio,r),a=s.priceRatioBase*Math.pow(s.priceRatio,r)}this._levelRatios.push({lowerLevel:t,upperLevel:e,priceRatioBase:a,outputRatioBase:o,priceRatio:i,outputRatio:n})},i.addAchieve=function(t,e,i,n){this._achieves.push({level:t,outputRatio:e,priceUseGold:n,priceUseDiamond:i})},t.createAllProjects=function(){for(var e=new Array,i=[[1,1,2,1e3],[10,5,2,1e3],[300,25,2,1e3],[6e3,160,2,1e3],[3e5,3200,2,1e3],[45e6,64e3,4,1e3],[675e7,32e4,4,1e3],[135e10,64e5,4,1e3],[27e13,32e6,4,1e3],[54e15,64e7,4,1e3],[108e17,32e8,8,1e4],[2.16e21,64e9,8,1e4],[4.32e23,32e10,8,1e4],[8.64e25,64e11,8,1e4],[1.73e28,32e12,8,1e4],[3.46e30,64e13,16,1e4],[6.91e32,32e14,16,1e4],[1.38e35,64e15,16,1e4],[2.76e37,32e16,16,1e4],[5.53e39,64e17,16,1e4]],n=[[119,1190,157e3,603e4,1e10,1e17,5e25,8e50,4e64,1e200],[1190,11900,157e4,603e5,5e13,1e19,2.5e27,8e52,6e66,1e200],[35800,358e3,471e5,181e7,4e14,2e20,1.25e29,4e54,9e68,1e200],[716e3,716e4,941e6,362e8,2e15,1e21,6.25e30,4e56,1.35e71,1e200],[358e5,358e6,471e8,181e10,4e16,5e21,3.13e32,4e58,2.03e73,1e200],[537e7,537e8,706e10,271e12,16e17,2.5e23,6.25e34,4e60,3.04e75,1e200],[805e9,805e10,106e13,407e14,16e18,5e25,1.25e37,4e62,4.56e77,1e200],[161e12,161e13,212e15,814e16,1.6e21,1e28,2.5e39,4e64,6.83e79,1e200],[322e14,322e15,423e17,1.63e21,8e22,2e30,5e41,8e66,1.37e82,1e200],[644e16,644e17,8.47e21,3.26e23,1.6e25,4e32,1e44,1.6e69,2.73e84,1e200],[1.29e21,1.29e22,1.69e24,6.51e25,3.2e27,8e34,2e46,3.2e71,5.47e86,1e200],[2.58e23,2.58e24,3.39e26,1.3e28,6.4e29,1.6e37,4e48,6.4e73,1.09e89,1e200],[5.15e25,5.15e26,6.78e28,2.6e30,1.28e32,3.2e39,8e50,1.28e76,2.19e91,1e200],[1.03e28,1.03e29,1.36e31,5.21e32,2.56e34,6.4e41,1.6e53,2.56e78,4.37e93,1e200],[2.06e30,2.06e31,2.71e33,1.04e35,5.12e36,1.28e44,3.2e55,5.12e80,8.75e95,1e200],[4.12e32,4.12e33,5.42e35,2.08e37,1.02e39,2.56e46,6.4e57,1.02e83,1.75e98,1e200],[8.24e34,8.24e35,1.08e38,4.17e39,2.05e41,5.12e48,1.28e60,2.05e85,3.5e100,1e200],[1.65e37,1.65e38,2.17e40,8.33e41,4.1e43,1.02e51,2.56e62,4.1e87,7e102,1e200],[3.3e39,3.3e40,4.34e42,1.67e44,8.19e45,2.05e53,5.12e64,8.19e89,1.4e105,1e200],[6.6e41,6.6e42,8.67e44,3.33e46,1.64e48,4.1e55,1.02e67,1.64e92,2.8e107,1e200]],o=0;o<i.length;o++)e.push(t.createProject(i[o][0],i[o][1],i[o][2],i[o][3],n[o]));return e},t.createProject=function(e,i,n,o,a){var s=new t(e,i);return s.addLevelRatio(2,99,1.05,1),s.addLevelRatio(100,199,1.05,1),s.addLevelRatio(200,299,1.03,1),s.addLevelRatio(300,399,1.03,1),s.addLevelRatio(400,499,1.03,1),s.addLevelRatio(500,599,1.05,1.01),s.addLevelRatio(600,699,1.03,1.01),s.addLevelRatio(700,799,1.02,1.01),s.addLevelRatio(800,899,1.02,1.01),s.addLevelRatio(900,999,1.02,1.01),s.addLevelRatio(1e3,1199,1.03,1.005),s.addLevelRatio(1200,1399,1.02,1.005),s.addLevelRatio(1400,1599,1.02,1.005),s.addLevelRatio(1600,1799,1.02,1.005),s.addLevelRatio(1800,1999,1.02,1.005),s.addLevelRatio(2e3,2499,1.01,1.005),s.addLevelRatio(2500,2999,1.02,1.005),s.addLevelRatio(3e3,3499,1.01,1.005),s.addLevelRatio(3500,3999,1.01,1.005),s.addLevelRatio(4e3,4499,1.01,1.005),s.addLevelRatio(4500,4999,1.01,1.005),s.addLevelRatio(5e3,5999,1.01,1.005),s.addLevelRatio(6e3,6999,1.01,1.005),s.addLevelRatio(7e3,7999,1.007,1.005),s.addLevelRatio(8e3,8999,1.007,1.003),s.addLevelRatio(9e3,9999,1.007,1.003),s.addLevelRatio(1e4,99999,1.003,1.002),s.addAchieve(50,n,100,a[0]),s.addAchieve(100,2*n,100,a[1]),s.addAchieve(200,4*n,100,a[2]),s.addAchieve(300,8*n,100,a[3]),s.addAchieve(500,o,1e3,a[4]),s.addAchieve(1e3,o,2e3,a[5]),s.addAchieve(2e3,o,3e3,a[6]),s.addAchieve(5e3,1e4,4e3,a[7]),s.addAchieve(1e4,1e6,5e3,a[8]),s.addAchieve(1e5,1e10,1e4,a[8]),s},i.output=function(t,e,i){for(var n=1,o=1,a=1;a<=this._levelRatios.length;a++){var s=this._levelRatios[a-1];if(t>=s.lowerLevel&&t<=s.upperLevel){n=s.outputRatioBase*Math.pow(s.outputRatio,t-o);break}o=s.upperLevel}for(var r=1,a=1;a<=this._achieves.length&&e>=a;a++)r*=this._achieves[a-1].outputRatio;return Math.round(t*this._outputLevelOne*n*r*i)},i.priceOf=function(t){for(var e=1,i=1,n=1;n<=this._levelRatios.length;n++){var o=this._levelRatios[n-1];if(t>=o.lowerLevel&&t<=o.upperLevel){e=o.priceRatioBase*Math.pow(o.priceRatio,t-i);break}i=o.upperLevel}return Math.round(this._priceLevelOne*e)},i.price=function(t,e){for(var i=0,n=t;t+e>n;n++)i+=this.priceOf(n);return i},i.achieve=function(t){return this._achieves[t-1]},t}();egret.registerClass(Project,"Project");var AuctionUI=function(t){function e(){t.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/auctionUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.refresh=function(){this.lblGold.text=application.format(application.usableGold()),this.lblDiamond.text=application.format(application.customer.diamond);var t=application.bidDay();this.renderLastBid(t),this.renderMaxBid(t),this.grpTrack.x=this.imgThumb.x,this.lblTrack.text="0%",this.imgFront.x=this.imgThumb.x,this.imgFront.y=this.imgThumb.y,this.imgFront.width=0,this.addGold=0,this.bid={gold:0,day:t,customer_id:application.customer.id,claimed:0},this.renderBid(0)},n.uiCompHandler=function(){this.refresh(),this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.gotoHome()},this),application.dao.addEventListener("Customer",function(t){this.lblGold.text=application.format(application.usableGold()),this.lblDiamond.text=application.format(application.customer.diamond)},this),this.imgBid.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBid,this),this.grpTrack.touchEnabled=!0,this.grpTrack.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginChangeBid,this),this.grpTrack.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onChangeBid,this),this.grpTrack.addEventListener(egret.TouchEvent.TOUCH_END,this.onEndChangeBid,this),this.btnAddGold.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("time",500))},this),this.btnAddDiamond.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new ChargeTipUI)},this),this.btnHelp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var t="1. 每天中午12点拍卖结束。\n";t+="2. 出价最高者成为今日头条，获得1枚勋章和2000个钻石的奖励。\n",t+="3. 未中标玩家的拍卖金币自动返还。\n",t+="4. 拍卖期间，系统自动显示截至上个小时的最高出价，为新出价的玩家提供参考。\n",t+="5. 玩家在拍卖结束前可以反复加价，每次加价最高为当前拥有的所有金币。\n",t+="6. 每天首次参加拍卖可以在礼物页面中领取100钻石奖励。\n",application.showHelp(t)},this)},n.renderLastBid=function(t){var e=this;application.dao.fetch("Bid",{succeed:0,day:t,customer_id:application.customer.id},{limit:1},function(t,i){t&&i.length>0&&(e.bid=i[0],application.bid=e.bid,e.renderBid(e.addGold))})},n.renderMaxBid=function(t){var e=this;application.dao.fetch("MaxBid",{day:t},{limit:1},function(t,i){t&&i.length>0?e.lblMaxBid.text=application.format(i[0].gold):e.lblMaxBid.text="0"})},n.renderBid=function(t){this.addGold=Math.floor(t),this.lblCurrentBid.text=application.format(this.addGold),this.lblLastBid.text=application.format(this.addGold+this.bid.gold)},n.onBid=function(){var t=this;t.bid.day==application.bidDay()?(t.bid.gold+=t.addGold,t.bid.gold>0?(t.bid.claimed=0,application.dao.save("Bid",t.bid),application.giftChanged(),esa.EgretSA.onJoinActivity("投标"),Toast.launch("投标成功"),application.bid=t.bid,application.guideUI&&application.guideUI.next(),t.back()):Toast.launch("投标的金币数量不能是0")):(Toast.launch("今天投标已经结束"),application.bid=null,t.refresh())},n.back=function(){this.dispatchEventWith(GameEvents.EVT_RETURN)},n.onBeginChangeBid=function(t){this.startX=t.stageX},n.onChangeBid=function(t){var e=t.stageX-this.startX;this.startX=t.stageX;var i=Math.max(this.imgThumb.x,this.grpTrack.x+e);i=Math.min(this.imgThumb.width+this.imgThumb.x-this.grpTrack.width,i),this.grpTrack.x=i;var n=Math.round(100*(this.grpTrack.x-this.imgThumb.x)/(this.imgThumb.width-this.grpTrack.width));this.lblTrack.text=n.toString()+"%",this.renderBid((application.customer.gold-this.bid.gold)*n/100),this.imgFront.width=this.grpTrack.x-this.imgThumb.x+20},n.onEndChangeBid=function(t){application.guideUI&&(this.bid.gold+this.addGold>0?application.guideUI.next():Toast.launch("投标的金币数量不能是0"))},e}(eui.Component);egret.registerClass(AuctionUI,"AuctionUI");var BlockUI=function(t){function e(){t.call(this),this.skinName="resource/custom_skins/blockUISkin.exml"}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(BlockUI,"BlockUI");var BuyAchieveUI=function(t){function e(e,i,n){t.call(this),this._myProject=e,this._project=i,this._achieve=n,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/buyAchieveUISkin.exml",this.imgIcon.source="b"+n.toString()+"_png",this.imgProject.source="t"+(e.sequence+1).toString()+"_png",this.lblRatio.text=application.format(i.achieve(n).outputRatio),this.lblLevel.text=i.achieve(n).level.toString(),this.lblGold.touchEnabled=!1,this.lblDiamond.touchEnabled=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=this;if(this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(t)},this),this._myProject.level<this._project.achieve(this._achieve).level||this._achieve>this._myProject.achieve+1||this._achieve<=this._myProject.achieve)this.imgBuyUseGold.source="",this.imgBuyUseDiamond.source="",this.lblGold.text="",this.lblDiamond.text="";else{var e=this._project.achieve(this._achieve).priceUseGold;this.lblGold.text=application.format(e);var i=this._project.achieve(this._achieve).priceUseDiamond;this.lblDiamond.text=i,application.usableGold()<e?(this.imgBuyUseGold.source="buttoncoinno_png",this.imgBuyUseGold.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.showUI(new BuyToolUI("time",500),t)},this)):this.imgBuyUseGold.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t._buy(e,0)},this),application.customer.diamond<i?(this.imgBuyUseDiamond.source="buttondiano_png",this.imgBuyUseDiamond.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.showUI(new ChargeTipUI,t)},this)):this.imgBuyUseDiamond.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t._buy(0,i)},this)}},n._buy=function(t,e){var i=this._project.output(this._myProject.level,this._achieve,this._myProject.tool_ratio),n=this._project.output(this._myProject.level,this._myProject.achieve,this._myProject.tool_ratio);this._myProject.achieve=this._achieve,application.buyOutput(t,e,i-n),Toast.launch("获得成就成功"),application.dao.save("Project",this._myProject),application.hideUI(this)},e}(eui.Component);egret.registerClass(BuyAchieveUI,"BuyAchieveUI");var BuyToolUI=function(t){function e(e,i){t.call(this),this._name=e,this._price=i,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/buyToolUISkin.exml",this.lblGold.touchEnabled=!1,this.lblPrice.touchEnabled=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=this;this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(t)},this),this.imgBuy.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.buy()},this),this.lblGold.text="","time"==this._name?(this.imgIcon.source="timeh_png",this.lblGold.text=application.format(3600*application.customer.output*48)):"hit"==this._name?this.imgIcon.source="hith_png":"ticket"==this._name?this.imgIcon.source="ticketh_png":"vip"==this._name&&(this.imgIcon.source="VIPh_png"),"time"==this._name||"hit"==this._name?(application.customer.diamond<this._price?this.imgBuy.source="buttondiano_png":this.imgBuy.source="buttondia_png",this.lblPrice.text=this._price.toString()):(this.imgBuy.source="topupbutton_png",this.lblPrice.text="")},n.buy=function(){"time"==this._name?this.buyTime():"hit"==this._name?this.buyHit():"ticket"==this._name?this.buyTicket():"vip"==this._name&&this.buyVIP()},n.buyTime=function(){application.customer.diamond>this._price?(application.customer.diamond-=this._price,application.earnGold(3600*application.customer.output*48),esa.EgretSA.onDiamondUse("购买了时光沙漏",1,this._price),Toast.launch("购买了时光沙漏"),application.hideUI(this)):application.showUI(new ChargeTipUI)},n.buyHit=function(){0==application.customer.total_hits?application.customer.diamond>this._price?(application.customer.diamond-=this._price,application.customer.total_hits=3,application.saveCustomer(),esa.EgretSA.onDiamondUse("购买了暴击",1,this._price),Toast.launch("购买了暴击"),application.hideUI(this)):application.showUI(new ChargeTipUI):Toast.launch("你还有"+application.customer.total_hits+"个暴击，请用完后再购买")},n.buyTicket=function(){2==application.customer.vip?Toast.launch("你已经购买了VIP，终身免费，不需要购买月票"):(application.buyTicket(),application.hideUI(this))},n.buyVIP=function(){2==application.customer.vip?Toast.launch("你已经购买了VIP，终身免费"):(application.buyVIP(),application.hideUI(this))},e}(eui.Component);egret.registerClass(BuyToolUI,"BuyToolUI");var ChargeTipUI=function(t){function e(){var e=this;t.call(this),this.skinName="resource/custom_skins/chargeTipUISkin.exml",this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(e)},this),this.imgCharge1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond",2)},this),this.imgCharge2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond600",5)},this),this.imgCharge3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond1300",10)},this),this.imgCharge4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond4500",30)},this),this.imgCharge5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond18000",100)},this),this.imgCharge6.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.charge("diamond100000",500)},this),this.imgCharge7.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.buyTicket()},this),this.imgCharge8.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.buyVIP()},this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(ChargeTipUI,"ChargeTipUI");var FirstChargeBonusUI=function(t){function e(){var e=this;t.call(this),this.skinName="resource/custom_skins/firstChargeBonusUISkin.exml",this.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(e)},this),this.btnCharge.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(e),application.showUI(new ChargeTipUI)},this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(FirstChargeBonusUI,"FirstChargeBonusUI");var GiftCategory;!function(t){t[t.Login=1]="Login",t[t.Online=2]="Online",t[t.Bid=3]="Bid",t[t.Ticket=4]="Ticket",t[t.Share=5]="Share",t[t.Charge=6]="Charge",t[t.Output=7]="Output",t[t.Attention=8]="Attention"}(GiftCategory||(GiftCategory={}));var GiftUI=function(t){function e(){t.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/giftUISkin.exml",this.imgPicks=[this.imgPick1,this.imgPick2,this.imgPick3,this.imgPick4,this.imgPick5,this.imgPick6,this.imgPick7,this.imgPick8],this.imgRet.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.hideUI(this)},this),this.imgPick1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickGift(this.gift(GiftCategory.Login))},this),this.imgPick2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickGift(this.gift(GiftCategory.Online))},this),this.imgPick3.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickBidGift()},this),this.imgPick4.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickTicketGift()},this),this.imgPick5.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickShareGift()},this),this.imgPick6.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickFirstChargeGift()},this),this.imgPick7.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickOutputGift()},this),this.imgPick8.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.pickAttentionGift()},this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.pickGift=function(t){0==t.locked&&(this.lockGift(t,2),this.updateCustomer(t))},n.pickBidGift=function(){var t=this.gift(GiftCategory.Bid);0==t.locked?this.pickGift(t):1==t.locked&&(application.hideUI(this),application.gotoAuction())},n.pickTicketGift=function(){var t=this.gift(GiftCategory.Ticket);0==t.locked?this.pickGift(t):1==t.locked&&(application.hideUI(this),application.gotoTool())},n.pickShareGift=function(){var t=this,e=t.gift(GiftCategory.Share);0==e.locked?t.pickGift(e):1==e.locked&&application.share(function(){t.lockGift(e,0)})},n.pickFirstChargeGift=function(){var t=this.gift(GiftCategory.Charge);0==t.locked?this.pickGift(t):1==t.locked&&(application.hideUI(this),application.showUI(new FirstChargeBonusUI))},n.pickOutputGift=function(){var t=this.gift(GiftCategory.Output);if(0==t.locked){var e=10*t.data;t.data=e.toString(),application.log10(application.customer.output)>=application.log10(e)?this.lockGift(t,0):this.lockGift(t,2),this.lblOutputGift.text=application.format(e),this.updateCustomer(t)}},n.pickAttentionGift=function(){var t=this,e=t.gift(GiftCategory.Attention);0==e.locked?t.pickGift(e):1==e.locked&&application.attention(function(){t.lockGift(e,0)})},n.lockGift=function(t,e){t.locked=e,this.renderGift(t),application.dao.save("Gift",t)},n.refresh=function(){this.uiCompHandler()},n.uiCompHandler=function(){var t=this;application.dao.fetch("Gift",{customer_id:application.customer.id},{order:"category ASC"},function(e,i){if(e){t.gifts=i;for(var n=864e5,o=Math.floor((new Date).getTime()/n),a=0;a<i.length;a++)if(i[a].category!=GiftCategory.Charge&&2==i[a].locked){var s=Math.floor(new Date(i[a].update_time).getTime()/n);o>s&&(i[a].locked=1)}t.renderGift(t.gift(GiftCategory.Login)),t.renderOnlineGift(),t.renderGift(t.gift(GiftCategory.Bid)),t.renderTicketGift(),t.renderGift(t.gift(GiftCategory.Share)),t.renderGift(t.gift(GiftCategory.Charge)),t.renderOutputGift(),t.renderGift(t.gift(GiftCategory.Attention))
}})},n.renderOnlineGift=function(){var t=this.gift(GiftCategory.Online);if(this.lblOnlineGiftTimeout.text="",1==t.locked){var e=new Date(application.customer.last_login),i=new Date,n=Math.floor((i.getTime()-e.getTime())/1e3);if(n>3600)this.lockGift(t,0);else{this.onlineGiftTimeout=3600-n;var o=new egret.Timer(1e3,this.onlineGiftTimeout);o.addEventListener(egret.TimerEvent.TIMER,function(t){this.lblOnlineGiftTimeout.text=Math.floor(this.onlineGiftTimeout/60).toString()+":"+Math.floor(this.onlineGiftTimeout%60).toString(),this.onlineGiftTimeout>0&&(this.onlineGiftTimeout-=1)},this),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){this.lockGift(t,0)},this),o.start(),this.renderGift(t)}}else this.renderGift(t)},n.renderTicketGift=function(){var t=this.gift(GiftCategory.Ticket);if(0==application.customer.vip)this.lblTicketGiftTimeout.text="";else if(2==application.customer.vip)this.lblTicketGiftTimeout.text="永久";else{var e=new Date(application.customer.ticket),i=new Date,n=e.getTime()-i.getTime(),o=Math.floor(n/864e5);0>=o?this.lblTicketGiftTimeout.text="":this.lblTicketGiftTimeout.text=o.toString()+"天"}this.renderGift(t)},n.renderOutputGift=function(){var t=this.gift(GiftCategory.Output);this.lblOutputGift.text=application.format(t.data),this.renderGift(t)},n.gift=function(t){return this.gifts[t-1]},n.renderGift=function(t){var e=this.imgPicks[t.category-1];1==t.locked?t.category==GiftCategory.Share?e.source="share_png":t.category==GiftCategory.Attention?e.source="att_png":e.source="unpick_png":0==t.locked?e.source="pick_png":e.source="picked_png"},n.updateCustomer=function(t){var e="";t.diamond>0&&(e+="获得"+t.diamond.toString()+"钻石",esa.EgretSA.onDiamondReward(t.diamond,"礼物奖励")),t.gold>0&&(e+=e.length>0?"，":"获得",e+=t.gold.toString()+"金币"),t.metal>0&&(e+=e.length>0?"，":"获得",e+=t.metal.toString()+"奖章"),Toast.launch(e),application.customer.metal+=t.metal,application.customer.gold+=t.gold,application.customer.diamond+=t.diamond,application.saveCustomer()},e}(eui.Component);egret.registerClass(GiftUI,"GiftUI");var GuideUI=function(t){function e(){var e=this;t.call(this),this.step=0,this.skinName="resource/custom_skins/guideUISkin.exml",this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.over()},this);var i=!0,n=0;this.timer=new egret.Timer(100,0),this.timer.addEventListener(egret.TimerEvent.TIMER,function(t){n%5==0&&(i=!i),n+=1,i?"guideconti_png"!=this.imgFinger.source?this.imgFinger.y-=1:this.imgFinger.x-=1:"guideconti_png"!=this.imgFinger.source?this.imgFinger.y+=1:this.imgFinger.x+=1},this),this.timer.start(),this.imgBonus.visible=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setOverCallback=function(t){this.overCallback=t},n.next=function(){switch(this.step){case 1:if(this.click++,5==this.click){this.step++;break}return;default:this.step++}switch(this.step){case 1:this.renderStep1();break;case 2:this.renderStep2();break;case 3:this.renderStep3();break;case 4:this.renderStep4();break;case 5:this.renderStep5();break;case 6:this.renderStep6();break;case 7:this.renderStep7();break;case 8:this.renderStep8()}},n.renderStep1=function(){this.click=0,this.imgSpeak.source="G1_png",this.imgFocus.source="highlight1_png",this.imgFinger.source="guidearr_png",this.renderBlock(121,77,288,350),this.imgFinger.x=354,this.imgFinger.y=281,this.imgFocus.x=78,this.imgFocus.y=315,this.imgSpeak.x=151,this.imgSpeak.y=607,this.imgBg.x=0,this.imgBg.y=523,this.touchEnabled=!1,this.imgFocus.touchEnabled=!1,this.imgBg.touchEnabled=!1},n.renderStep2=function(){this.imgSpeak.source="G2_png",this.imgFocus.source="highlight2_png",this.renderBlock(247,409,156,104),this.imgFinger.x=308,this.imgFinger.y=377,this.imgFocus.x=206,this.imgFocus.y=384,this.imgSpeak.x=140,this.imgSpeak.y=601},n.renderStep3=function(){this.imgSpeak.source="G3_png"},n.renderStep4=function(){this.renderBlock(95,709,143,91),this.imgSpeak.source="G4_png",this.imgFocus.source="highlight3_png",this.imgFinger.x=155,this.imgFinger.y=671,this.imgFocus.x=74,this.imgFocus.y=702,this.imgSpeak.x=139,this.imgSpeak.y=597,this.imgBg.x=0,this.imgBg.y=518},n.renderStep5=function(){this.renderBlock(0,300,480,173),this.imgSpeak.source="G5_png",this.imgFinger.x=44,this.imgFinger.y=300,this.imgFocus.x=-14,this.imgFocus.y=325,this.imgSpeak.x=138,this.imgSpeak.y=505,this.imgBg.x=0,this.imgBg.y=423},n.renderStep6=function(){this.renderBlock(0,540,480,191),this.imgSpeak.source="G6_png",this.imgFocus.source="highlight4_png",this.imgFinger.x=226,this.imgFinger.y=536,this.imgFocus.x=4,this.imgFocus.y=537,this.imgSpeak.x=138,this.imgSpeak.y=390,this.imgBg.x=0,this.imgBg.y=316},n.renderStep7=function(){this.imgSpeak.source="G7_png",this.imgFinger.source="guideconti_png",this.imgFocus.visible=!1,this.renderBlock(0,0,0,0),this.imgFinger.x=395,this.imgFinger.y=679,this.imgSpeak.x=138,this.imgSpeak.y=599,this.imgBg.x=0,this.imgBg.y=523,this.touchEnabled=!0,this.touchChildren=!0,this.imgFinger.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){this.next()},this)},n.renderStep8=function(){this.imgSpeak.source="G8_png",this.imgFinger.visible=!1,this.imgBonus.visible=!0,this.renderBlock(0,0,0,0),this.imgBonus.x=376,this.imgBonus.y=653,this.imgBonus.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){this.over()},this)},n.renderBlock=function(t,e,i,n){this.rcRight.x=t+i,this.rcRight.y=0,this.rcRight.height=800,this.rcRight.width=480-this.rcRight.x,this.rcTop.x=this.rcTop.y=0,this.rcTop.height=e,this.rcTop.width=this.rcRight.x,this.rcMiddle.x=0,this.rcMiddle.y=e,this.rcMiddle.width=t,this.rcMiddle.height=n,this.rcBottom.x=0,this.rcBottom.y=e+n,this.rcBottom.width=this.rcTop.width,this.rcBottom.height=this.rcRight.height-e-n},n.over=function(){application.hideUI(this),application.guideUI=null,application.customer.metal+=1,application.customer.diamond+=500,application.saveCustomer(),this.timer.stop(),this.overCallback&&this.overCallback()},e}(eui.Component);egret.registerClass(GuideUI,"GuideUI");var HelpUI=function(t){function e(e){var i=this;t.call(this),this.skinName="resource/custom_skins/helpUISkin.exml",this.lblContent.text=e,this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.hideUI(i)},this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(HelpUI,"HelpUI");var HomeUI=function(t){function e(){t.call(this),this.gold=0,this.diamond=0,this.output=0,this.hit=0,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/homeUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=this;t.lblAddGold.visible=!1,t.imgAddGold.visible=!1,t.lblAddGold.backgroundColor=16777215,t.imgHit.visible=!1,t.imgGift.visible=!1,t.btnHome.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnHandler,t),t.btnRank.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnHandler,t),t.btnTool.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnHandler,t),t.btnAuction.addEventListener(egret.TouchEvent.TOUCH_TAP,t.btnHandler,t),t.btns=[t.btnHome,t.btnRank,t.btnTool,t.btnAuction],t.imgAvatar.source=application.avatarUrl(application.customer),t.renderCustomer(),t.lblTotalHits.text="x"+application.customer.total_hits.toString(),t.renderTotalHits(),t.renderProjects(),t.renderBeauty(),t.lblHit.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.onHit()},this),t.btnHit.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.onHit()},this),t.btnGift.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new GiftUI,this)},this),t.btnHelp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showHelp("")},this),t.btnAddGold.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("time",500))},this),t.btnAddDiamond.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new ChargeTipUI,this)},this),t.imgCharge.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){0==application.customer.charge?application.showUI(new FirstChargeBonusUI,this):application.showUI(new ChargeTipUI,this)},this),application.dao.addEventListener("Project",function(t){var e=t.data;this.renderProject(e)},this),application.dao.addEventListener("Customer",function(t){this.renderCustomer()},this),application.dao.addEventListener("Bid",function(t){this.renderCustomer()},this),application.dao.addEventListener("Gift",function(t){this.renderGift()},this),t.renderGiftDynamically(),t.gotoHome(),application.guideUI?(application.guideUI.setOverCallback(function(){t.earnGoldDynamically(),t.renderBid(),t.refreshBidAtNoon()}),this.addChild(application.guideUI),application.guideUI.next()):(t.earnGoldDynamically(),t.renderBid(),t.refreshBidAtNoon())},n.renderGiftDynamically=function(){this.renderGift(),application.stopwatch.addEventListener("hour",function(t){this.renderGift()},this)},n.renderGift=function(){var t=this;application.dao.fetch("Gift",{customer_id:application.customer.id,locked:0},{limit:1},function(e,i){e&&i.length>0?t.imgGift.visible=!0:t.imgGift.visible=!1})},n.earnGoldDynamically=function(){var t=5;application.stopwatch.addEventListener("second",function(e){e.data%t==0&&this.earnGold(t)},this)},n.renderTotalHits=function(){var t=this;application.stopwatch.addEventListener("hour",function(e){e.data%4==0&&application.dao.rest("hits",{customer_id:application.customer.id},function(e,i){e&&(application.customer.total_hits=i.hits,t.lblTotalHits.text="x"+application.customer.total_hits.toString())})},this)},n.refreshBidAtNoon=function(){var t=this;application.stopwatch.addEventListener("minute",function(e){t.bid&&application.bidDay()==t.bid.day||(t.renderBid(),application.refreshBid(function(e){t.renderCustomer()}))},this)},n.renderBid=function(){var t=this;application.dao.fetch("Bid",{succeed:1},{limit:1,order:"create_time desc"},function(e,i){e&&i.length>0&&(t.bid=i[0],application.customer.id==t.bid.customer_id?(0==t.bid.claimed?(application.showUI(new WinUI(t.bid),t),application.earnOfflineGold()):(t.renderOfflineGold(),application.earnBids()),t.renderBidCustomer(application.customer)):(application.dao.fetch("Customer",{id:t.bid.customer_id},{limit:1},function(e,i){e&&i.length>0&&t.renderBidCustomer(i[0])}),t.renderOfflineGold(),application.earnBids()))})},n.renderOfflineGold=function(){application.customer.offline_gold>0&&application.showUI(new OfflineGoldUI,this)},n.renderBidCustomer=function(t){this.lblBidName.text=t.name,this.lblBidGold.text=application.format(this.bid.gold),1==t.hide_winner?this.imgBidAvatar.source="Ahide_png":this.imgBidAvatar.source=application.avatarUrl(t)},n.renderProjects=function(){var t=this;t.projectItems=new Array,t.grpProject.removeChildren(),application.dao.fetch("Project",{customer_id:application.customer.id},{order:"sequence asc"},function(e,i){if(e&&i.length>0){for(var n=1,o=0;o<i.length;o++){var a=i[o];t.renderProject(a),0==a.unlocked&&(n+=application.projects[a.sequence].output(a.level,a.achieve,a.tool_ratio))}n!=application.customer.output&&(application.customer.output=n,application.saveCustomer(),t.lblOutput.text=application.format(t.getOutput()))}})},n.renderBeauty=function(){var t=this,e=RES.getRes("animation_json"),i=RES.getRes("animation_png"),n=new egret.MovieClipDataFactory(e,i);t.mcBeauty=new egret.MovieClip(n.generateMovieClipData("")),t.mcBeauty.x=70,t.mcBeauty.y=90,t.addChildAt(t.mcBeauty,3),t.mcBeauty.touchEnabled=!0,t.mcBeauty.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.onBeauty()},this)},n.onBeauty=function(){this.mcBeauty.play(3),this.earnGold(1),application.guideUI&&application.guideUI.next()},n.earnGold=function(t){var e=this.getOutput()*t;application.earnGold(e),this.grpAddGold.y=370,this.imgAddGold.visible=!0,this.lblAddGold.visible=!0,this.lblAddGold.text="+"+application.format(e);var i=new egret.Timer(100,20);i.addEventListener(egret.TimerEvent.TIMER,function(t){this.grpAddGold.y-=10},this),i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){this.lblAddGold.visible=!1,this.imgAddGold.visible=!1},this),i.start()},n.onHit=function(){var t=this;if(!(t.hit>0))if(application.customer.total_hits>0){application.customer.total_hits-=1,application.saveCustomer(),t.lblTotalHits.text="x"+application.customer.total_hits.toString(),t.hit=59,t.lblOutput.text=application.format(t.getOutput()),Toast.launch("获得10倍收益，持续60秒"),t.imgHit.visible=!0;var e=new egret.Timer(1e3,59);e.addEventListener(egret.TimerEvent.TIMER,function(e){t.lblHit.text=t.hit.toString(),t.hit>0&&(t.hit=t.hit-1)},this),e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.hit=0,t.lblHit.text="59",t.lblOutput.text=application.format(t.getOutput()),t.imgHit.visible=!1},this),e.start()}else application.showUI(new BuyToolUI("hit",100),this)},n.getOutput=function(){return this.hit>0?10*application.customer.output:application.customer.output},n.animateStep=function(t,e,i){if(e!=i){var n=Math.min(Math.abs(e-i),20),o=(i-e)/n,a=new egret.Timer(50,n);a.addEventListener(egret.TimerEvent.TIMER,function(i){t.text=application.format(Math.round(e+o*i.target.currentCount))},this),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.text=application.format(i)},this),a.start()}},n.renderCustomer=function(){this.gold!=application.usableGold()&&(this.animateStep(this.lblGold,this.gold,application.usableGold()),this.gold=application.usableGold()),this.diamond!=application.customer.diamond&&(this.animateStep(this.lblDiamond,this.diamond,application.customer.diamond),this.diamond=application.customer.diamond),this.output!=this.getOutput()&&(this.animateStep(this.lblOutput,this.output,this.getOutput()),this.output=this.getOutput()),this.lblTotalHits.text="x"+application.customer.total_hits.toString(),application.customer.charge>0&&(this.imgCharge.source="charge_png")},n.renderProject=function(t){if(t){var e=t.sequence;if(e>=this.projectItems.length){var i=new ProjectItem(t,application.projects[e]);this.projectItems[e]=i,this.grpProject.addChildAt(i,e)}}},n.gotoHome=function(){this._uiFocused=null,this.selectFooter(this.btnHome)},n.gotoTool=function(){var t=this;this._toolUI?this._toolUI.refresh():(this._toolUI=new ToolUI,this._toolUI.addEventListener(GameEvents.EVT_RETURN,function(){t.gotoPage(GamePages.HOME,!0)},this)),this._uiFocused=this._toolUI,this.selectFooter(this.btnTool)},n.gotoRank=function(){var t=this;this._rankUI?this._rankUI.refresh():(this._rankUI=new RankUI,this._rankUI.addEventListener(GameEvents.EVT_RETURN,function(){t.gotoPage(GamePages.HOME,!0)},this)),this._uiFocused=this._rankUI,this.selectFooter(this.btnRank)},n.gotoAuction=function(){var t=this;this._auctionUI?this._auctionUI.refresh():(this._auctionUI=new AuctionUI,this._auctionUI.addEventListener(GameEvents.EVT_RETURN,function(){t.gotoPage(GamePages.HOME,!0)},this)),this._uiFocused=this._auctionUI,this.selectFooter(this.btnAuction),application.guideUI&&application.guideUI.next()},n.btnHandler=function(t){if(t.currentTarget==this._btnFocused)return void(this._btnFocused.selected=!0);switch(t.currentTarget){case this.btnHome:this.gotoPage(GamePages.HOME,!0);break;case this.btnRank:this.gotoPage(GamePages.RANK,!1);break;case this.btnTool:this.gotoPage(GamePages.TOOL,!1);break;case this.btnAuction:this.gotoPage(GamePages.AUCTION,!1)}},n.resetFocus=function(){this._uiFocused&&(this._uiFocused.parent&&this._uiFocused.parent.removeChild(this._uiFocused),this._uiFocused=null),this._btnFocused&&(this._btnFocused.selected=!1,this._btnFocused.enabled=!0,this._btnFocused=null)},n.gotoPage=function(t,e){switch(this._pageFocused=t,this.resetFocus(),t){case GamePages.HOME:return void this.gotoHome();case GamePages.RANK:this._rankUI||e?this.gotoRank():this.loadPage();break;case GamePages.TOOL:this._toolUI||e?this.gotoTool():this.loadPage();break;case GamePages.AUCTION:this._auctionUI||e?this.gotoAuction():this.loadPage()}this._uiFocused&&(this._uiFocused.horizontalCenter=0,this._uiFocused.verticalCenter=0,application.guideUI?this.addChildAt(this._uiFocused,this.getChildIndex(application.guideUI)):this.addChild(this._uiFocused))},n.loadPage=function(){this.enableFooter(!1),this.dispatchEventWith(GameEvents.EVT_LOAD_PAGE,!1,this._pageFocused)},n.pageReadyHandler=function(t){this.enableFooter(!0),this.gotoPage(t,!0)},n.selectFooter=function(t){this._btnFocused&&(this._btnFocused.selected=!1),this._btnFocused=t,this._btnFocused.selected=!0},n.enableFooter=function(t){for(var e=0;e<this.btns.length;e++)this.btns[e].enabled=t},e}(eui.Component);egret.registerClass(HomeUI,"HomeUI");var LandingUI=function(t){function e(){t.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/landingUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=this;t.btnLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){nest.easyuser.startup({egretAppId:90359,version:2,debug:!0},function(e){0==e.result&&t.login()})},t)},n.login=function(){application.hideUI(this);var t=nest.easyuser.getLoginTypes();if(t.length>0){var e=new LoginUI(t,function(t){nest.easyuser.login(t,function(t){0==t.result?application.login(t):egret.log("log Fail")})});application.showUI(e)}else nest.easyuser.login({},function(t){0==t.result?application.login(t):egret.log("log Fail")})},e}(eui.Component);egret.registerClass(LandingUI,"LandingUI");var LoadingUI=function(t){function e(){t.call(this),this.textField=new egret.TextField,this.textField.textColor=16777215,this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.addChild(this.textField)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setProgress=function(t,e){this.textField.text="加载..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var LoginButton=function(t){function e(e,i){t.call(this),this.type=e,this.url=i,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/loginButtonSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=new eui.Image;if(t.source=this.type+"_png",this.icon_group.addChildAt(t,0),this.url&&""!=this.url){this.right_ui.visible=!0;var e=new egret.DisplayObjectContainer,i=new egret.Shape;i.graphics.beginFill(16711680),i.graphics.drawCircle(100,100,100),i.graphics.endFill(),e.addChild(i);var n=new egret.Bitmap;RES.getResByUrl(this.url,function(t){n.texture=t,n.width=200,n.height=200},this,RES.ResourceItem.TYPE_IMAGE),e.addChild(n),n.mask=i,this.icon_group.addChildAt(e,0)}else this.right_ui.visible=!1;this.name_txt.text=this.getLabelName(this.type,this.url&&""!=this.url)},n.getLabelName=function(t,e){var i="";switch(t){case"qq":i="qq";break;case"wx":i="微信";break;case"wb":i="微博";break;default:i="默认"}return e?i+"--一键登录":i+"登录"},e}(eui.Component);egret.registerClass(LoginButton,"LoginButton");var LoginUI=function(t){function e(e,i){t.call(this),this.loginTypes=e,this.onChoose=i,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/loginUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){for(var t=0;t<this.loginTypes.length;t++){var e=this.loginTypes[t],i="";e.accInfo&&e.accInfo.avatarUrl&&(i=e.accInfo.avatarUrl);var n=new LoginButton(e.loginType,i);n.name=e.loginType,this.btnGroup.addChild(n),n.scaleX=n.scaleY=.5,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.onChoose(this.loginTypes[parseInt(t.currentTarget.name)])},this)}},e}(eui.Component);egret.registerClass(LoginUI,"LoginUI");var OfflineGoldUI=function(t){function e(){var e=this;t.call(this),this.skinName="resource/custom_skins/offlineGoldUISkin.exml",this.lblGold.text=application.format(application.customer.offline_gold),this.lblHour.text=application.customer.offline_hours,this.lblMinute.text=application.customer.offline_minutes,this.imgOK.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.earnOfflineGold(),application.hideUI(e)},this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(OfflineGoldUI,"OfflineGoldUI");var ProjectItem=function(t){function e(e,i){t.call(this),this._myProject=e,this._project=i,this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/projectItemSkin.exml",this.imgIcon.source=(e.sequence+1).toString()+"_png",this.imgTitle.source="t"+(e.sequence+1).toString()+"_png"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.uiCompHandler=function(){var t=this;this.renderProject(),this.renderAchieves(),this.lblPrice.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onUpgrade()},this),this.imgUpgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onUpgrade()},this),this.imgUpgrade10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){0==t._myProject.unlocked&&t.upgrade(10)},this),this.imgUpgrade100.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){0==t._myProject.unlocked&&t.upgrade(100)},this),application.dao.addEventListener("Project",function(t){var e=t.data;e.id==this._myProject.id&&(this._myProject=e,this.renderProject(),this.renderAchieves())},this),application.dao.addEventListener("Customer",function(t){t.data;this.renderProject()},this)},n.onUpgrade=function(){1==this._myProject.unlocked?this.unlock():this.upgrade(1)},n.output=function(){return this._project.output(this._myProject.level,this._myProject.achieve,this._myProject.tool_ratio)},n.renderProject=function(){if(1==this._myProject.unlocked){var t=this._project.priceOf(1);this.lblLevel.text="0",this.lblOutput.text="0",this.lblPrice.text=application.format(t),application.usableGold()>t?this.imgUpgrade.source="updatedp2_png":this.imgUpgrade.source="upgradeg_png",this.imgUpgrade10.source="upgrade10g_png",this.imgUpgrade100.source="upgrade100g_png"}else{var t=this._project.priceOf(this._myProject.level);this.lblLevel.text=this._myProject.level,this.lblOutput.text=application.format(this.output()),this.lblPrice.text=application.format(t),this._myProject.sequence%2==0?(application.usableGold()>this._project.price(this._myProject.level,10)?this.imgUpgrade10.source="upgrade10_png":this.imgUpgrade10.source="upgrade10g_png",application.usableGold()>this._project.price(this._myProject.level,100)?this.imgUpgrade100.source="upgrade100_png":this.imgUpgrade100.source="upgrade100g_png",application.usableGold()>t?this.imgUpgrade.source="upgrade_png":this.imgUpgrade.source="upgradeg2_png"):(application.usableGold()>this._project.price(this._myProject.level,10)?this.imgUpgrade10.source="upgrade10b_png":this.imgUpgrade10.source="upgrade10g_png",application.usableGold()>this._project.price(this._myProject.level,100)?this.imgUpgrade100.source="upgrade100b_png":this.imgUpgrade100.source="upgrade100g_png",application.usableGold()>t?this.imgUpgrade.source="upgradeb_png":this.imgUpgrade.source="upgradeg2_png")}},n.renderAchieves=function(){var t=this;t.grpAchieve.removeChildren();for(var e=1;10>=e;e++)this.grpAchieve.addChild(this.renderAchieve(e))},n.renderAchieve=function(t){var e=this,i=new eui.Group,n=new eui.Image,o="acv"+t.toString()+"_png";return t<=this._myProject.achieve?(n.source=o,i.addChild(n)):this._myProject.level>=this._project.achieve(t).level&&t==this._myProject.achieve+1?(n.source=o,i.addChild(n),n=new eui.Image,n.source="acvnone_png",i.addChild(n)):(n.source="acvlock_png",i.addChild(n)),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.showUI(new BuyAchieveUI(e._myProject,e._project,t))},this),i},n.upgrade=function(t){var e=this,i=this._project.price(this._myProject.level,t);if(application.usableGold()<i)return void Toast.launch("没有足够的金币");var n=this.output();this._myProject.level+=t,application.dao.save("Project",e._myProject),application.buyOutput(i,0,e.output()-n),application.guideUI&&application.guideUI.next()},n.unlock=function(){var t=this,e=this._project.priceOf(1);if(application.usableGold()<e)return void Toast.launch("没有足够的金币");if(t._myProject.unlocked=0,application.dao.save("Project",t._myProject),t._myProject.sequence<19){var i={};i.customer_id=application.customer.id,i.sequence=t._myProject.sequence+1,i.unlocked=1,i.achieve=0,i.level=1,application.dao.save("Project",i),application.buyOutput(e,0,t.output())}else application.buyOutput(e,0,t.output());application.guideUI&&application.guideUI.next()},e}(eui.Component);egret.registerClass(ProjectItem,"ProjectItem");var RankItem=function(t){function e(e,i,n){if(t.call(this),this.skinName="resource/custom_skins/rankItemSkin.exml",e){if(0==i)return void(this.imgBg.source="RG_png");this.lblRank.text=i.toString(),n.id==application.customer.id?this.imgBg.source="RY_png":this.imgBg.source="RG_png"}else 1==i?this.imgBg.source="RR_png":2==i?this.imgBg.source="RBlue_png":3==i?this.imgBg.source="RGreen_png":(this.imgBg.source="RG_png",this.lblRank.text=i.toString());this.imgAvatar.source=application.avatarUrl(n),this.lblName.text=n.name,this.lblMetal.text=n.metal,this.lblGold.text=application.format(n.accumulated_gold)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(RankItem,"RankItem");var RankUI=function(t){function e(){t.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/rankUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.refresh=function(){var t=this;t.dataReady=0,application.dao.rest("rank",{customer_id:application.customer.id},function(e,i){e&&(t.ranks=i,t.dataReady++,2==t.dataReady&&t.renderCustomers())}),application.dao.fetch("Customer",{},{limit:10,order:"metal DESC, accumulated_gold DESC"},function(e,i){e&&(t.customers=i,t.dataReady++,2==t.dataReady&&t.renderCustomers())})},n.renderCustomers=function(){for(var t=0;t<this.ranks.length;t++)if(this.ranks[t].customer)for(var e=0;e<this.customers.length;e++)this.ranks[t].customer.id==this.customers[e].id&&(this.customers[e].metal=this.ranks[t].customer.metal,this.customers[e].accumulated_gold=this.ranks[t].customer.accumulated_gold);this.listMyRank.removeChildren();for(var t=0;t<this.ranks.length;t++)if(this.ranks[t].customer){var i=new RankItem(!0,this.ranks[t].rank,this.ranks[t].customer);this.listMyRank.addChild(i)}this.listRank.removeChildren();for(var t=0;t<this.customers.length;t++){var i=new RankItem(!1,t+1,this.customers[t]);this.listRank.addChild(i)}},n.uiCompHandler=function(){this.refresh(),this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.gotoHome()},this)},n.back=function(){this.dispatchEventWith(GameEvents.EVT_RETURN)},e}(eui.Component);egret.registerClass(RankUI,"RankUI");var Toast=function(t){function e(i,n,o){var a=this;t.call(this),console.log("Toast:",i);var s=new egret.Bitmap(e._txtrToastBg);this.addChild(s);var r=new egret.TextField;r.multiline=!0,r.size=20,r.bold=!0,r.textColor=16777215,r.stroke=2,r.strokeColor=0,r.text=i,r.fontFamily="微软雅黑",r.textAlign=egret.HorizontalAlign.CENTER,r.width=.84*n,r.x=(e._txtrToastBg.textureWidth-r.width)/2,r.y=6,this.addChild(r),s.height=12+r.height,this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.x=.5*n,this.y=.618*o,this.alpha=0,egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){a.parent&&a.parent.removeChild(a)})}__extends(e,t);var i=(__define,e);i.prototype;return e.init=function(t,e){console.log("Toast.init",e),this._cont=t,this._txtrToastBg=e},e.launch=function(t){if(this._cont){var i=new e(t,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(i)}},e}(egret.DisplayObjectContainer);egret.registerClass(Toast,"Toast");var ToolItem=function(t){function e(e,i,n,o){var a=this;t.call(this),this._project=i,this._myProject=e,this.skinName="resource/custom_skins/toolItemSkin.exml",this.img100.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.buy(100,1)},this),this.img900.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.buy(900,10)},this),this.imgIcon.source=n,this.imgTitle.source=o,this.refresh()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.refresh=function(){this.lbl1.text=application.format(this._myProject.tool_ratio),this.lbl100.text=application.format(this.ratio(this._myProject.tool_ratio,1)),this.lbl900.text=application.format(this.ratio(this._myProject.tool_ratio,10))},n.buy=function(t,e){if(application.customer.diamond>=t){var i=this.output();this._myProject.tool_ratio=this.ratio(this._myProject.tool_ratio,e),application.buyOutput(0,t,this.output()-i),application.dao.save("Project",this._myProject),esa.EgretSA.onDiamondUse("购买了运营加倍",1,t),Toast.launch("购买成功"),this.refresh()}else application.showUI(new ChargeTipUI)},n.ratioOne=function(t){var e=[1,5,50,200,2e3,1e4,1e5,5e5,5e6,25e6,125e6,625e6,5e9,4e10,2e11],i=application.log10(t);if(i<e.length)return t+e[i];for(var n=e[e.length-1],o=0;o<i-e.length;o++)n=10*n;return t+n},n.ratio=function(t,e){for(var i=0;e>i;i++)t=this.ratioOne(t);return t},n.output=function(){return this._project.output(this._myProject.level,this._myProject.achieve,this._myProject.tool_ratio)},e}(eui.Component);egret.registerClass(ToolItem,"ToolItem");var ToolUI=function(t){function e(){t.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/toolUISkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.refresh=function(){var t=this;this.lblGold.text=application.format(application.usableGold()),this.lblDiamond.text=application.format(application.customer.diamond);var e=new eui.TileLayout;e.horizontalGap=0,e.verticalGap=0,e.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,e.rowAlign=eui.RowAlign.TOP,e.paddingTop=0,e.paddingRight=0,e.paddingLeft=0,e.paddingBottom=0,e.requestedColumnCount=2,this.grpProject.layout=e,t.grpProject.removeChildren(),application.dao.fetch("Project",{customer_id:application.customer.id},{order:"sequence asc"},function(e,i){if(e&&i.length>0)for(var n=0;n<i.length;n++)t.addProject(i[n])})},n.uiCompHandler=function(){this.refresh(),this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.gotoHome()},this),application.dao.addEventListener("Customer",function(t){this.lblGold.text=application.format(application.usableGold()),this.lblDiamond.text=application.format(application.customer.diamond)},this),this.btnAddGold.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("time",500))},this),this.btnAddDiamond.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new ChargeTipUI)},this),this.imgHit.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("hit",100),this)},this),this.imgTime.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("time",500),this)},this),this.imgTicket.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("ticket",19),this)},this),this.imgVIP.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){application.showUI(new BuyToolUI("vip",49),this)},this)},n.addProject=function(t){if(t&&0==t.unlocked){var e=t.sequence,i=new ToolItem(t,application.projects[e],(e+1).toString()+"_png","t"+(e+1).toString()+"_png");this.grpProject.addChildAt(i,e)}},e}(eui.Component);egret.registerClass(ToolUI,"ToolUI");var TrueLoadingUI=function(t){function e(){var e=this;t.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){e.hasEventListener(egret.Event.ENTER_FRAME)&&e.removeEventListener(egret.Event.ENTER_FRAME,e.runLoading,e)},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e.setProgress(0,1),e.addEventListener(egret.Event.ENTER_FRAME,e.runLoading,e)},this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this._imgBg=new eui.Image,this._imgBg.source="Loginb_png",this.addChild(this._imgBg),this._loadingRun=new egret.Bitmap(RES.getRes("loading_run_png")),this.addChild(this._loadingRun),this._loadingRun.anchorOffsetX=.5*this._loadingRun.width,this._loadingRun.anchorOffsetY=.5*this._loadingRun.height,this._loadingRun.x=.5*this.stage.stageWidth,this._loadingRun.y=.5*this.stage.stageHeight,this._txProgress=new egret.TextField,this._txProgress.textAlign=egret.HorizontalAlign.CENTER,this._txProgress.verticalAlign=egret.VerticalAlign.MIDDLE,this._txProgress.x=.5*this.stage.stageWidth-100,this._txProgress.width=200,this._txProgress.y=.5*this.stage.stageHeight-100,this._txProgress.height=200,this._txProgress.size=14,this._txProgress.stroke=1,this._txProgress.strokeColor=0,this.addChild(this._txProgress)
},n.removeBgImage=function(){this.removeChild(this._imgBg)},n.runLoading=function(t){this._loadingRun.rotation+=3},n.setProgress=function(t,e){this._txProgress&&(this._txProgress.text=Math.round(t/e*100)+"%")},e}(eui.Group);egret.registerClass(TrueLoadingUI,"TrueLoadingUI");var WinUI=function(t){function e(e){var i=this;t.call(this),this.skinName="resource/custom_skins/winUISkin.exml",this.imgBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){application.earnBids(),application.hideUI(i)},this),this.imgHide.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){1==application.customer.hide_winner?application.customer.hide_winner=0:application.customer.hide_winner=1,i.renderAvatar()},this),this.renderAvatar()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.renderAvatar=function(){1==application.customer.hide_winner?(this.imgHide.source="hidecancel_png",this.imgAvatar.source="Ahide_png"):(this.imgHide.source="Awinhide_png",this.imgAvatar.source=application.avatarUrl(application.customer))},e}(eui.Component);egret.registerClass(WinUI,"WinUI");